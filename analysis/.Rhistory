mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Year, Week) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
year_week <- paste(week_count_member$Year, week_count_member$Week, sep = "-")
week_count_member <- cbind(week_count_member, year_week)
colnames(week_count_member)[5]<-"year_week"
rm(year_week)
# 2020年第53周有3次直播算在了2021年第53周（不存在）内，两次嘉晚饭一次贝拉单播
# 处理方式：删除2021年第53周的3行
# 将2次嘉晚饭直播分别计入2020年第53周向晚和2020年底53嘉然内,各增2次
# 将贝拉单播计入2020年第53周贝拉内，增1次
# 2021年第52周有1次直播算在了2022年第52周（无数据）内，为向晚、贝拉、珈乐、嘉然、乃琳参与
# 处理方式：删除2022年52周的5行，将此5次分别计入五人的2021年52周内，2021年52周的各成员记录均增1
delcols <- c()
for (i in 1:nrow(week_count_member)){
if (week_count_member$year_week[i] == "2020-53"){
if (is.element(week_count_member$Member[i], c("嘉然", "向晚"))){
week_count_member$Count[i] <- week_count_member$Count[i] + 2
}
if (week_count_member$Member[i] == "贝拉"){
week_count_member$Count[i] <- week_count_member$Count[i] + 1
}
}
if (week_count_member$year_week[i] == "2021-52"){
print(i)
week_count_member$Count[i] <- week_count_member$Count[i] + 1
}
if (week_count_member$year_week[i] == "2021-53"){
delcols <- c(delcols, i)
}
if (week_count_member$year_week[i] == "2022-52"){
delcols <- c(delcols, i)
}
}
week_count_member <- week_count_member[-delcols,]
rm(delcols)
# 可视化
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "年份-周", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "年份-周", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
data$Year
data <- within(data, {
Week = as.factor(strftime(Date, format = "%V"))
Month = as.factor(strftime(Date, format = "%m"))
Year = as.factor(year(Date))
})
str(data)
# 按周计算直播次数
# 按月算无人为0，但按周算需考虑整周未直播的情况
week_count_member <- rbind(
data[Ava,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
year_week <- paste(week_count_member$Year, week_count_member$Week, sep = "-")
week_count_member <- cbind(week_count_member, year_week)
colnames(week_count_member)[5]<-"year_week"
rm(year_week)
# Clear environment
rm(list = ls())
# Set working directory
directory <- "D:/A-SOUL/ZJStatistics/ZJStatistics/calendar/"
fileName <- "calendar_minimal_members_to510.csv"
# Import data
data <- read.csv(file = paste(directory, fileName, sep=''), header = TRUE, sep = ",", quote = "\"")
data$Date <- as.Date(data$Date, format = '%Y/%m/%d')
data <- within(data, {
memberNum <- (nchar(Member) + 2) %/% 4
})
library(ggplot2)
library(ggrepel)
library(dplyr)
library(lubridate)
Ava <- grepl("向晚", data$Member)
Bella <- grepl("贝拉", data$Member)
Carol <- grepl("珈乐", data$Member)
Diana <- grepl("嘉然", data$Member)
Eileen <- grepl("乃琳", data$Member)
data <- within(data, {
Week = as.factor(strftime(Date, format = "%V"))
Month = as.factor(strftime(Date, format = "%m"))
Year = as.factor(year(Date))
})
# 每周直播次数
week_count <- data %>%
group_by(Year, Week) %>%
summarise(Count = n())
year_week <- paste(week_count$Year, week_count$Week, sep = "-")
week_count <- cbind(week_count, year_week)
colnames(week_count)[4]<-"year_week"
rm(year_week)
# 2020年第53周有3次直播算在了2021年第53周（不存在）内
# 处理方式：删除2021年第53周一行，将此3次直播计入2020年第53周内
# 2021年第52周有1次直播算在了2022年第52周（无数据）内
# 处理方式：删除2022年第52周一行，将该次直播计入2021年第52周内
delcols <- c()
for (i in 1:nrow(week_count)){
if (week_count$year_week[i] == "2020-53"){
week_count$Count[i] <- week_count$Count[i] + 3
}
if (week_count$year_week[i] == "2021-52"){
week_count$Count[i] <- week_count$Count[i] + 1
}
if (week_count$year_week[i] == "2021-53"){
delcols <- c(delcols, i)
}
if (week_count$year_week[i] == "2022-52"){
delcols <- c(delcols, i)
}
}
week_count <- week_count[-delcols,]
rm(delcols)
# 可视化
ggplot(week_count, aes(x = paste(Year, Week, sep = "-"), y = Count, group=1)) +
geom_point() +
geom_line() +
labs(x = "年份-周", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size=6))
# 按月计算直播次数
month_count <- data %>%
group_by(Year, Month) %>%
summarise(Count = n())
year_month <- paste(month_count$Year, month_count$Month, sep = "-")
month_count <- cbind(month_count, year_month)
rm(year_month)
#可视化
ggplot(month_count, aes(x = paste(Year, Month, sep = "-"), y = Count, group=1)) +
geom_point() +
geom_line() +
labs(x = "年份-月", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# 按周计算直播次数
# 按月算无人为0，但按周算需考虑整周未直播的情况
week_count_member <- rbind(
data[Ava,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
year_week <- paste(week_count_member$Year, week_count_member$Week, sep = "-")
week_count_member <- cbind(week_count_member, year_week)
colnames(week_count_member)[5]<-"year_week"
rm(year_week)
week_count_member$Week[1]
as.number(week_count_member$Week[1])
as.numeric(week_count_member$Week[1])
View(data)
# 按周计算直播次数
# 按月算无人为0，但按周算需考虑整周未直播的情况
week_count_member <- rbind(
data[Ava,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
year_week <- paste(week_count_member$Year, week_count_member$Week, sep = "-")
week_count_member <- cbind(week_count_member, year_week)
colnames(week_count_member)[5]<-"year_week"
rm(year_week)
# 2020年第53周有3次直播算在了2021年第53周（不存在）内，两次嘉晚饭一次贝拉单播
# 处理方式：删除2021年第53周的3行
# 将2次嘉晚饭直播分别计入2020年第53周向晚和2020年底53嘉然内,各增2次
# 将贝拉单播计入2020年第53周贝拉内，增1次
# 2021年第52周有1次直播算在了2022年第52周（无数据）内，为向晚、贝拉、珈乐、嘉然、乃琳参与
# 处理方式：删除2022年52周的5行，将此5次分别计入五人的2021年52周内，2021年52周的各成员记录均增1
# 因此前考虑了所有整合，将不存在的组合剔除
delcols <- c()
for (i in 1:nrow(week_count_member)){
if (week_count_member$year_week[i] == "2020-53"){
if (is.element(week_count_member$Member[i], c("嘉然", "向晚"))){
week_count_member$Count[i] <- week_count_member$Count[i] + 2
}
if (week_count_member$Member[i] == "贝拉"){
week_count_member$Count[i] <- week_count_member$Count[i] + 1
}
}
if (week_count_member$year_week[i] == "2021-52"){
week_count_member$Count[i] <- week_count_member$Count[i] + 1
}
if (week_count_member$year_week[i] == "2021-53"){
delcols <- c(delcols, i)
}
if (week_count_member$year_week[i] == "2022-52"){
delcols <- c(delcols, i)
}
if (week_count_member$Year[i] == "2020"){
if (as.numeric(week_count_member$Week[i]) < 50){
delcols <- c(delcols, i)
}
}
if (week_count_member$Year[i] == "2021"){
if (as.numeric(week_count_member$Week[i]) > 52){
delcols <- c(delcols, i)
}
if (week_count_member$Year[i] == "2022"){
if (as.numeric(week_count_member$Week[i]) > 18){
delcols <- c(delcols, i)
}
}
week_count_member <- week_count_member[-delcols,]
rm(delcols)
# 按周计算直播次数
# 按月算无人为0，但按周算需考虑整周未直播的情况
week_count_member <- rbind(
data[Ava,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Year, Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
year_week <- paste(week_count_member$Year, week_count_member$Week, sep = "-")
week_count_member <- cbind(week_count_member, year_week)
colnames(week_count_member)[5]<-"year_week"
rm(year_week)
# 2020年第53周有3次直播算在了2021年第53周（不存在）内，两次嘉晚饭一次贝拉单播
# 处理方式：删除2021年第53周的3行
# 将2次嘉晚饭直播分别计入2020年第53周向晚和2020年底53嘉然内,各增2次
# 将贝拉单播计入2020年第53周贝拉内，增1次
# 2021年第52周有1次直播算在了2022年第52周（无数据）内，为向晚、贝拉、珈乐、嘉然、乃琳参与
# 处理方式：删除2022年52周的5行，将此5次分别计入五人的2021年52周内，2021年52周的各成员记录均增1
# 因此前考虑了所有整合，将不存在的组合剔除
delcols <- c()
for (i in 1:nrow(week_count_member)){
if (week_count_member$year_week[i] == "2020-53"){
if (is.element(week_count_member$Member[i], c("嘉然", "向晚"))){
week_count_member$Count[i] <- week_count_member$Count[i] + 2
}
if (week_count_member$Member[i] == "贝拉"){
week_count_member$Count[i] <- week_count_member$Count[i] + 1
}
}
if (week_count_member$year_week[i] == "2021-52"){
week_count_member$Count[i] <- week_count_member$Count[i] + 1
}
if (week_count_member$year_week[i] == "2021-53"){
delcols <- c(delcols, i)
}
if (week_count_member$year_week[i] == "2022-52"){
delcols <- c(delcols, i)
}
if (week_count_member$Year[i] == "2020"){
if (as.numeric(week_count_member$Week[i]) < 50){
delcols <- c(delcols, i)
}
}
if (week_count_member$Year[i] == "2021"){
if (as.numeric(week_count_member$Week[i]) > 52){
delcols <- c(delcols, i)
}
}
if (week_count_member$Year[i] == "2022"){
if (as.numeric(week_count_member$Week[i]) > 18){
delcols <- c(delcols, i)
}
}
}
week_count_member <- week_count_member[-delcols,]
rm(delcols)
# 可视化
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "年份-周", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "年份-周", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 可视化
# 每周直播次数优先 点数较多 不单独标出点的数字
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "年份-周", y = "直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 可视化
# 每周直播次数优先 点数较多 不单独标出点的数字
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "年份-周", y = "直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
ggplot(week_count_member[week_count_member$Member=="珈乐",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1, color = "purple")) +
geom_point() +
geom_line() +
labs(x = "年份-周", y = "直播次数（珈乐）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
week_count_member$Member=="珈乐"
ggplot(data = week_count_member[week_count_member$Member=="珈乐",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1, color = "purple")) +
geom_point() +
geom_line() +
labs(x = "年份-周", y = "直播次数（珈乐）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="珈乐",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1) +
geom_point() +
geom_line() +
labs(x = "年份-周", y = "直播次数（珈乐）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="珈乐",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point() +
geom_line(color = "purple") +
labs(x = "年份-周", y = "直播次数（珈乐）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="珈乐",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point(color = "purple") +
geom_line(color = "purple") +
labs(x = "年份-周", y = "直播次数（珈乐）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="向晚",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point(color = "steelblue1") +
geom_line(color = "steelblue1") +
labs(x = "年份-周", y = "直播次数（向晚）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="贝拉",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point(color = "red") +
geom_line(color = "red") +
labs(x = "年份-周", y = "直播次数（贝拉）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="珈乐",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point(color = "purple") +
geom_line(color = "purple") +
labs(x = "年份-周", y = "直播次数（珈乐）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="嘉然",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point(color = "palevioletred1") +
geom_line(color = "palevioletred1") +
labs(x = "年份-周", y = "直播次数（嘉然）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="乃琳",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point(color = "snow4") +
geom_line(color = "snow4") +
labs(x = "年份-周", y = "直播次数（乃琳）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="珈乐",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point(color = "purple") +
geom_line(color = "purple", size=2) +
labs(x = "年份-周", y = "直播次数（珈乐）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="珈乐",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point(color = "purple", size =5) +
geom_line(color = "purple", size=2) +
labs(x = "年份-周", y = "直播次数（珈乐）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="珈乐",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point(color = "purple", size =5) +
geom_line(color = "purple", size=2, alpha = 0.5) +
labs(x = "年份-周", y = "直播次数（珈乐）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = week_count_member[week_count_member$Member=="珈乐",], aes(x = paste(Year, Week, sep = "-"), y = Count, group = 1)) +
geom_point(color = "purple") +
geom_line(color = "purple") +
labs(x = "年份-周", y = "直播次数（珈乐）")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point(size=4, alpha=0.5) +
geom_line(size=2, alpha = 0.5) +
labs(x = "年份-周", y = "直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 可视化
# 每周直播次数优先 点数较多 不单独标出点的数字
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point(size=4, alpha=0.5) +
geom_line(size=1.5, alpha = 0.5) +
labs(x = "年份-周", y = "直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 可视化
# 每周直播次数优先 点数较多 不单独标出点的数字
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point(size=4, alpha=0.5) +
geom_line(size=1.5, alpha = 0.5) +
labs(x = "年份-周", y = "直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 可视化
# 每周直播次数优先 点数较多 不单独标出点的数字
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point() +
geom_line(size=1.5, alpha = 0.5) +
labs(x = "年份-周", y = "直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 可视化
# 每周直播次数优先 点数较多 不单独标出点的数字
ggplot(week_count_member, aes(x = paste(Year, Week, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point(size=4, alpha=0.5) +
geom_line() +
labs(x = "年份-周", y = "直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 按月计算直播次数
month_count_member <- rbind(
data[Ava,] %>%
group_by(Year, Month) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Year, Month) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Year, Month) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Year, Month) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Year, Month) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
year_month <- paste(month_count_member$Year, month_count$Month, sep = "-")
month_count <- data.frame(month_count, year_month)
rm(year_month)
#可视化
ggplot(month_count_member, aes(x = paste(Year, Month, sep = "-"), y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "年份-月", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
