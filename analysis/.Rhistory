# Create the line chart using ggplot2
ggplot(month_summary, aes(x=Var1, y=Freq, group=1)) +
geom_line() +
ggtitle("直播次数/月折线图") +
xlab("周一日期") +
ylab("直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size=6))
# Create a new column 'week' that groups the dates by week
data$Month <- cut(data$Date, breaks = "month")
# Create a summary data frame with the count of rows for each week
month_summary <- data.frame(table(data$Month))
# Create the line chart using ggplot2
ggplot(month_summary, aes(x=Var1, y=Freq, group=1)) +
geom_line() +
ggtitle("直播次数/月折线图") +
xlab("每月第一天日期") +
ylab("直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size=6))
# Create a new column 'week' that groups the dates by week
data$Week <- cut(data$Date, breaks = "week")
# Create a summary data frame with the count of rows for each week
week_summary <- data.frame(table(data$Week))
# Create the line chart using ggplot2
ggplot(week_summary, aes(x=Var1, y=Freq, group=1)) +
geom_line() +
ggtitle("直播次数/周折线图") +
xlab("周一日期") +
ylab("直播次数")+
geom_text_repel(aes(label = Freq), size=3)
library(ggplot2)
library(tidyverse)
library(lubridate)
library(ggrepel)
# Create a new column 'week' that groups the dates by week
data$Week <- cut(data$Date, breaks = "week")
# Create a summary data frame with the count of rows for each week
week_summary <- data.frame(table(data$Week))
# Create the line chart using ggplot2
ggplot(week_summary, aes(x=Var1, y=Freq, group=1)) +
geom_line() +
ggtitle("直播次数/周折线图") +
xlab("周一日期") +
ylab("直播次数")+
geom_text_repel(aes(label = Freq), size=3)
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size=6))
# Create a new column 'week' that groups the dates by week
data$Week <- cut(data$Date, breaks = "week")
# Create a summary data frame with the count of rows for each week
week_summary <- data.frame(table(data$Week))
# Create the line chart using ggplot2
ggplot(week_summary, aes(x=Var1, y=Freq, group=1)) +
geom_line() +
ggtitle("直播次数/周折线图") +
xlab("周一日期") +
ylab("直播次数")+
geom_text_repel(aes(label = Freq), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size=6))
# Create a new column 'week' that groups the dates by week
data$Week <- cut(data$Date, breaks = "week")
# Create a summary data frame with the count of rows for each week
week_summary <- data.frame(table(data$Week))
# Create the line chart using ggplot2
ggplot(week_summary, aes(x=Var1, y=Freq, group=1)) +
geom_line() +
ggtitle("直播次数/周折线图") +
xlab("周一日期") +
ylab("直播次数")+
geom_text_repel(aes(label = Freq), size=2)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size=6))
# Create a new column 'week' that groups the dates by week
data$Week <- cut(data$Date, breaks = "week")
# Create a summary data frame with the count of rows for each week
week_summary <- data.frame(table(data$Week))
# Create the line chart using ggplot2
ggplot(week_summary, aes(x=Var1, y=Freq, group=1)) +
geom_line() +
ggtitle("直播次数/周折线图") +
xlab("周一日期") +
ylab("直播次数")+
geom_text_repel(aes(label = Freq), size=2.5)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size=6))
# Create a new column 'week' that groups the dates by week
data$Month <- cut(data$Date, breaks = "month")
# Create a summary data frame with the count of rows for each week
month_summary <- data.frame(table(data$Month))
# Create the line chart using ggplot2
ggplot(month_summary, aes(x=Var1, y=Freq, group=1)) +
geom_line() +
ggtitle("直播次数/月折线图") +
xlab("每月第一天日期") +
ylab("直播次数")+
geom_text_repel(aes(label = Freq), size=2.5)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size=6))
library(ggplot2)
library(tidyverse)
library(lubridate)
library(ggrepel)
# Clear environment
rm(list = ls())
# Set working directory
directory <- "D:/A-SOUL/ZJStatistics/ZJStatistics/stream/"
fileName <- "stream_to510.csv"
# Import data
data <- read.csv(file = paste(directory, fileName, sep=''), header = TRUE, sep = ",", quote = "\"")
summary(data)
# Remove all lines containing NA
data = na.omit(data)
data$Date <- parse_date_time2(data$Date, "Ymd", tz="PRC")
data$StartTime <- parse_date_time2(data$StartTime, "Ymd HMS", tz="PRC")
data$EndTime <- parse_date_time2(data$EndTime, "Ymd HMS", tz="PRC")
data <- data[order(as.POSIXct(data$StartTime)),]
Duration <- difftime(data$EndTime, data$StartTime, units = "secs")
data <- cbind(data, Duration)
Member_num <- (nchar(data$Member)+2)/4
data <- cbind(data, Member_num)
Ava <- grepl("向晚", data$Member)
Bella <- grepl("贝拉", data$Member)
Carol <- grepl("珈乐", data$Member)
Diana <- grepl("嘉然", data$Member)
Eileen <- grepl("乃琳", data$Member)
# 找到独特的组合，按照组合长度排序
member_combo <- unique(data$Member)
member_combo <- member_combo[order(nchar(member_combo), member_combo, decreasing = TRUE)]
print(member_combo)
print(paste0("总共有", length(member_combo), "种成员组合"))
# Create a summary data frame with the count of rows for each unique value in the 'Member' column
member_summary <- data.frame(table(data$Member))
member_summary$Var1 <- factor(member_summary$Var1, levels=member_summary$Var1[order(member_summary$Freq, decreasing=FALSE)])
# Create the bar chart using ggplot2
ggplot(member_summary, aes(x=Var1, y=Freq)) +
geom_bar(stat="identity") +
ggtitle("全部成员(组合)直播次数") +
xlab("成员(组合)") +
ylab("直播次数") +
geom_text(aes(label=Freq), vjust=0.2, hjust = 0, color="red", size=3) +
coord_flip()
member_number_summary <- data.frame(table(data$Member_num))
member_number_summary$Var1 <- factor(member_number_summary$Var1, levels=member_number_summary$Var1[order(member_number_summary$Freq, decreasing=FALSE)])
ggplot(member_number_summary, aes(x=Var1, y=Freq)) +
geom_bar(stat="identity", width=0.5) +
ggtitle("成员组合（不同人数）直播次数") +
xlab("成员人数") +
ylab("直播次数") +
geom_text(aes(label=Freq), vjust=0.2, hjust = 0, color="red", size=3) +
coord_flip()
member_number_summary4 <- data.frame(table(data$Member[data$Member_num==4]))
member_number_summary4$Var1 <- factor(member_number_summary4$Var1, levels=member_number_summary4$Var1[order(member_number_summary4$Freq, decreasing=FALSE)])
ggplot(member_number_summary4, aes(x=Var1, y=Freq)) +
geom_bar(stat="identity", width=0.5) +
ggtitle("四人团播直播次数") +
xlab("组合") +
ylab("直播次数") +
geom_text(aes(label=Freq), vjust=0.2, hjust = 0, color="red", size=3) +
coord_flip()
member_number_summary3 <- data.frame(table(data$Member[data$Member_num==3]))
member_number_summary3$Var1 <- factor(member_number_summary3$Var1, levels=member_number_summary3$Var1[order(member_number_summary3$Freq, decreasing=FALSE)])
ggplot(member_number_summary3, aes(x=Var1, y=Freq)) +
geom_bar(stat="identity", width=0.5) +
ggtitle("三人团播直播次数") +
xlab("组合") +
ylab("直播次数") +
geom_text(aes(label=Freq), vjust=0.2, hjust = 0, color="red", size=3) +
coord_flip()
member_number_summary2 <- data.frame(table(data$Member[data$Member_num==2]))
member_number_summary2$Var1 <- factor(member_number_summary2$Var1, levels=member_number_summary2$Var1[order(member_number_summary2$Freq, decreasing=FALSE)])
ggplot(member_number_summary2, aes(x=Var1, y=Freq)) +
geom_bar(stat="identity", width=0.7) +
ggtitle("双播直播次数") +
xlab("组合") +
ylab("直播次数") +
geom_text(aes(label=Freq), vjust=0.2, hjust = 0, color="red", size=3) +
coord_flip()
member_number_summary1 <- data.frame(table(data$Member[data$Member_num==1]))
member_number_summary1$Var1 <- factor(member_number_summary1$Var1, levels=member_number_summary1$Var1[order(member_number_summary1$Freq, decreasing=FALSE)])
ggplot(member_number_summary1, aes(x=Var1, y=Freq)) +
geom_bar(stat="identity", width=0.5) +
ggtitle("单播直播次数") +
xlab("成员") +
ylab("直播次数") +
geom_text(aes(label=Freq), vjust=0.2, hjust = 0, color="red", size=3) +
coord_flip()
member_participate <- c(table(Ava)["TRUE"], table(Bella)["TRUE"], table(Carol)["TRUE"], table(Diana)["TRUE"], table(Eileen)["TRUE"])
member_participate <- data.frame(member_participate, c("向晚", "贝拉", "珈乐", "嘉然","乃琳"))
colnames(member_participate) <- c("Participate_Count", "Member")
# sort by count
member_participate$Member <- factor(member_participate$Member,
levels = member_participate$Member[order(member_participate$Participate_Count, decreasing = FALSE)])
ggplot(member_participate, aes(x=Member, y=Participate_Count)) +
geom_bar(stat="identity", width=0.5) +
ggtitle("参与直播次数") +
xlab("成员") +
ylab("参与直播次数") +
geom_text(aes(label=Participate_Count), vjust=0.2, hjust = 0, color="red", size=3) +
coord_flip()
# Create a new column 'week' that groups the dates by week
data$Week <- cut(data$Date, breaks = "week")
# Create a summary data frame with the count of rows for each week
week_summary <- data.frame(table(data$Week))
# Create the line chart using ggplot2
ggplot(week_summary, aes(x=Var1, y=Freq, group=1)) +
geom_line() +
ggtitle("直播次数/周折线图") +
xlab("周一日期") +
ylab("直播次数")+
geom_text_repel(aes(label = Freq), size=2.5)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size=6))
# Create a new column 'week' that groups the dates by week
data$Month <- cut(data$Date, breaks = "month")
# Create a summary data frame with the count of rows for each week
month_summary <- data.frame(table(data$Month))
# Create the line chart using ggplot2
ggplot(month_summary, aes(x=Var1, y=Freq, group=1)) +
geom_line() +
ggtitle("直播次数/月折线图") +
xlab("每月第一天日期") +
ylab("直播次数")+
geom_text_repel(aes(label = Freq), size=2.5)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size=6))
# 按月计算直播次数
month_count_member <- rbind(
data[Ava,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Weekh) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
# 按月计算直播次数
month_count_member <- rbind(
data[Ava,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
month_count_member
# 按月计算直播次数
month_count_member <- rbind(
data[Ava,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
ggplot(month_count_member, aes(x = Week, y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "周一日期", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 按月计算直播次数
month_count_member <- rbind(
data[Ava,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
ggplot(month_count_member, aes(x = Month, y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "每月一号日期", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
typeof(month_count_member$Month)
month_count_member$Month
typeof(month_count_member$Month)
month(month_count_member$Month)
format(as.Date(month_count_member$Month), "%Y-%m")
# 按月计算直播次数
month_count_member <- rbind(
data[Ava,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
month_count_member <- format(as.Date(month_count_member$Month), "%Y-%m")
ggplot(month_count_member, aes(x = Month, y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 按月计算直播次数
month_count_member <- rbind(
data[Ava,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
month_count_member$Month <- format(as.Date(month_count_member$Month), "%Y-%m")
ggplot(month_count_member, aes(x = Month, y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 按月计算直播次数
month_count_member <- rbind(
data[Ava,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Month) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
month_count_member$Month <- format(as.Date(month_count_member$Month), "%Y-%m")
ggplot(month_count_member, aes(x = Month, y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 按周计算直播次数
week_count_member <- rbind(
data[Ava,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Week) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
ggplot(week_count_member, aes(x = Week, y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "每周第一天日期", y = "直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 按周计算直播次数
week_count_member <- rbind(
data[Ava,] %>%
group_by(Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Week, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
ggplot(week_count_member, aes(x = Week, y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "每周第一天日期", y = "直播次数")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
# 按月计算直播次数
month_count_member <- rbind(
data[Ava,] %>%
group_by(Month, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "向晚"),
data[Bella,] %>%
group_by(Month, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "贝拉"),
data[Carol,] %>%
group_by(Month, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "珈乐"),
data[Diana,] %>%
group_by(Month, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "嘉然"),
data[Eileen,] %>%
group_by(Month, .drop = FALSE) %>%
summarise(Count = n()) %>%
mutate(Member = "乃琳")
)
month_count_member$Month <- format(as.Date(month_count_member$Month), "%Y-%m")
ggplot(month_count_member, aes(x = Month, y = Count, group = Member, color = Member)) +
geom_point() +
geom_line() +
labs(x = "", y = "直播次数")+
geom_text_repel(aes(label = Count), size=3)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_color_manual(name = "成员", values = c("snow4", "steelblue1", "palevioletred1", "purple", "red"))
